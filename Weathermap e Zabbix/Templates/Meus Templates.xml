<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2021-06-24T11:20:19Z</date>
    <groups>
        <group>
            <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
        </group>
        <group>
            <name>Company/CLIENTE/NetworkDevices/Satelites</name>
        </group>
        <group>
            <name>Templates/CLIENTE/Network</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>CLIENTE - Template Network BGP</template>
            <name>CLIENTE - Template Network BGP</name>
            <description>Based on BGP4-MIB and CISCO-BGP4-MIB.&#13;
&#13;
Trigger.&#13;
Starts with flap of PeerStatus catched with function diff() .&#13;
&#13;
Recovery.&#13;
If PeerAdmStatus = 1 (ADM_DOWN).&#13;
or&#13;
PeerStatus = 6 (Established).&#13;
then&#13;
Close problem.&#13;
&#13;
Advertised prefixes and accepted prefixes on LLD works ONLY in Cisco devices, you must disable for other vendors in order to avoid waste of resources trying to catch information not available (because is based on Cisco-BGP-MIB).&#13;
&#13;
Enjoy!&#13;
Created by:&#13;
Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>BGP</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>BGP Peers</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.2.1.15.3.1.7,{#SNMPVALUE2},1.3.6.1.2.1.15.3.1.9]</snmp_oid>
                    <key>bgppeerdiscovery</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <description>Macro SNMPVALUE = peer address.&#13;
Macro SNMPVALUE2 = remoteas.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Peer {#SNMPVALUE} accepted prefixes (only Cisco)</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.9.9.187.1.2.4.1.1.{#SNMPINDEX}.1.1</snmp_oid>
                            <key>cbgpPeerAcceptedPrefixes[{#SNMPVALUE}]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>HABILITAR SOMENTE SE O HOST SWITCH/ROTEADOR FOR CISCO.&#13;
&#13;
Counter 32</description>
                            <applications>
                                <application>
                                    <name>BGP</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Peer {#SNMPVALUE} advertised prefixes (only Cisco)</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.9.9.187.1.2.4.1.6.{#SNMPINDEX}.1.1</snmp_oid>
                            <key>cbgpPeerPrefixAdvertised[{#SNMPVALUE}]</key>
                            <history>7d</history>
                            <value_type>FLOAT</value_type>
                            <description>HABILITAR SOMENTE SE O HOST SWITCH/ROTEADOR FOR CISCO.&#13;
&#13;
Gauge 32</description>
                            <applications>
                                <application>
                                    <name>BGP</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Peer {#SNMPVALUE} admin state</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.15.3.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>PeerAdmStatus[{#SNMPVALUE}]</key>
                            <history>1w</history>
                            <applications>
                                <application>
                                    <name>BGP</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>BGP_ADM_STATUS_DEFAULT</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Peer {#SNMPVALUE} operational state</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.15.3.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>PeerStatus[{#SNMPVALUE}]</key>
                            <history>1w</history>
                            <description>Checa estado operacional do peer bgp.</description>
                            <applications>
                                <application>
                                    <name>BGP</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>BGP_OPERATIONAL_STATUS_DEFAULT</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network BGP:PeerStatus[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network BGP:PeerAdmStatus[{#SNMPVALUE}].last()}=1 or {CLIENTE - Template Network BGP:PeerStatus[{#SNMPVALUE}].last()}=6</recovery_expression>
                            <name>BGP Peer {#SNMPVALUE} AS {#SNMPVALUE2} on {HOSTNAME} has changed to {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Cisco IOS</template>
            <name>CLIENTE - Template Network Cisco IOS</name>
            <description>Template Cisco IOS Software releases 12.2(3.5) or later version: 0.15&#13;
Known Issues:&#13;
description : no if(in|out)(Errors|Discards) are available for vlan ifType&#13;
version : IOS for example: 	12.1(22)EA11, 15.4(3)M2&#13;
device : C2911, C7600</description>
            <templates>
                <template>
                    <name>CLIENTE_Template Cisco IOS Module Cisco CISCO-ENVMON-MIB</name>
                </template>
                <template>
                    <name>CLIENTE_Template Cisco IOS Module Cisco CISCO-MEMORY-POOL-MIB</name>
                </template>
                <template>
                    <name>CLIENTE_Template Cisco IOS Module Cisco CISCO-PROCESS-MIB</name>
                </template>
            </templates>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Satelites</name>
                </group>
            </groups>
            <macros>
                <macro>
                    <macro>{$CPU_UTIL_MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$MEMORY_UTIL_MAX}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$STORAGE_UTIL_CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$STORAGE_UTIL_WARN}</macro>
                    <value>80</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>CLIENTE - Template Network Cisco StackWise</template>
            <name>CLIENTE - Template Network Cisco StackWise</name>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Satelites</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Stack Info</name>
                </application>
                <application>
                    <name>Stack Port Info</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Ring Redundant</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.9.9.500.1.1.3.0</snmp_oid>
                    <key>cswRingRedundant</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <description>A value of 'true' is returned when the stackports are connected in such a way that it forms a redundant ring.</description>
                    <applications>
                        <application>
                            <name>Stack Info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>cswRingRedundant</name>
                    </valuemap>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Stack Port Info</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#CSWSTACKPORTOPERSTATUS},.1.3.6.1.4.1.9.9.500.1.2.2.1.1]</snmp_oid>
                    <key>cswStackPortOperStatus</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Stack port {#SNMPINDEX} status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.9.9.500.1.2.2.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cswStackPortOperStatus[{#SNMPINDEX}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <description>The state of the stackport.&#13;
up - Connected and operational.&#13;
down - Not connected to a neighboring switch or administrative down.&#13;
forcedDown - Shut down by stack manager due to mismatch or stackport errors.</description>
                            <applications>
                                <application>
                                    <name>Stack Port Info</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>cswStackPortOperStatus</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=1</recovery_expression>
                                    <name>Stack port status changed</name>
                                    <priority>WARNING</priority>
                                    <description>diff = 1 (ultima coleta tem valor diferente da anterior, indicando mudança de estado operacional)&#13;
&#13;
1 up - Connected and operational.&#13;
2 down - Not connected to a neighboring switch or administrative down.&#13;
3 forcedDown - Shut down by stack manager due to mismatch or stackport errors.</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Stack Info</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#CSWSWITCHNUMCURRENT},.1.3.6.1.4.1.9.9.500.1.2.1.1.1]</snmp_oid>
                    <key>cswSwitchNumCurrent</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Hardware priority {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.5.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchHwPriority[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>7d</trends>
                            <description>This object contains the hardware priority of a switch.  If two or more entries in this table have the same cswSwitchSwPriority value during the master election time,&#13;
the switch with the highest cswSwitchHwPriority will become&#13;
the master.&#13;
Note:This object will contain the value of 0 if the cswSwitchState value is other than 'ready'.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>MAC address {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchMacAddress[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>The MAC address of the switch.&#13;
Note:This object will contain the value of 0000:0000:0000 if the cswSwitchState value is other than 'ready'.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Switch number current {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchNumCurrent[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>7d</trends>
                            <description>This object contains the current switch identification number. This number should match any logical labeling on the switch.&#13;
For example, a switch whose interfaces are labeled 'interface #3' this value should be 3.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Role {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchRole[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>7d</trends>
                            <description>This object describes the function of the switch:&#13;
master - stack master.&#13;
member - active member of the stack.&#13;
notMember - none-active stack member, see cswSwitchState for status.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>cswSwitchRole</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Software image {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchSoftwareImage[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>The software image type running on the switch.&#13;
Note:This object will contain an empty string if the cswSwitchState value is other than 'ready'.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>State {#SNMPINDEX}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.500.1.2.1.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>cswSwitchState[{#CSWSWITCHNUMCURRENT}]</key>
                            <delay>5m</delay>
                            <history>365d</history>
                            <trends>7d</trends>
                            <description>The current state of a switch:&#13;
waiting - Waiting for a limited time on other switches in the stack to come online.&#13;
progressing - Master election or mismatch checks in progress.&#13;
added - The switch is added to the stack.&#13;
ready - The switch is operational.&#13;
sdmMismatch - The SDM template configured on the master is not supported by the new member.&#13;
verMismatch - The operating system version running on the master is different from the operating system version running on this member.&#13;
featureMismatch - Some of the features configured on the master are not supported on this member.&#13;
newMasterInit - Waiting for the new master to finish initialization after master switchover (Master Re-Init).&#13;
provisioned - The switch is not an active member of the stack.&#13;
invalid - The switch's state machine is in an invalid state.</description>
                            <applications>
                                <application>
                                    <name>Stack Info</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>cswSwitchState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=4</recovery_expression>
                                    <name>Switch state changed</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network F5</template>
            <name>CLIENTE - Template Network F5</name>
            <description>https://share.zabbix.com/network-appliances/big-ip-f5-portugues-br</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>Geral</name>
                </application>
                <application>
                    <name>Interfaces</name>
                </application>
                <application>
                    <name>Nodes</name>
                </application>
                <application>
                    <name>Pool</name>
                </application>
                <application>
                    <name>Rede</name>
                </application>
                <application>
                    <name>Requisições</name>
                </application>
                <application>
                    <name>Servidores Virtuais</name>
                </application>
                <application>
                    <name>Storage</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Status do Fan - 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.1.2.1.2.1</snmp_oid>
                    <key>sysChassisFanStatus.1</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Status do Fan - 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.1.2.1.2.2</snmp_oid>
                    <key>sysChassisFanStatus.2</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Status do Fan - 3</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.1.2.1.2.3</snmp_oid>
                    <key>sysChassisFanStatus.3</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Status do Fan - 4</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.1.2.1.2.4</snmp_oid>
                    <key>sysChassisFanStatus.4</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Status Fonte de Energia - 1</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.2.2.1.2.1</snmp_oid>
                    <key>sysChassisPowerSupplyStatus.1</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Status Fonte de Energia - 2</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.3.2.2.2.1.2.2</snmp_oid>
                    <key>sysChassisPowerSupplyStatus.2</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Template BigIP - Status Fan</name>
                    </valuemap>
                </item>
                <item>
                    <name>Uso de CPU % por Minuto.</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.1.2.20.29.0</snmp_oid>
                    <key>sysGlobalHostCpuUsageRatio1m</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;90</expression>
                            <name>Uso de CPU acima de 90%</name>
                            <priority>WARNING</priority>
                            <description>hcp-redes</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Memória Total</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.7.1.1.0</snmp_oid>
                    <key>sysHostMemoryTotal</key>
                    <delay>3600s</delay>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Memória em Uso</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.3375.2.1.7.1.2.0</snmp_oid>
                    <key>sysHostMemoryUsed</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Geral</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Nodes</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.3375.2.2.4.2.3.1.20]</snmp_oid>
                    <key>ltmNodeAddrName</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <description>Nome dos Nodes</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Conexões Ativas (Server-Side) em $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.3375.2.2.4.2.3.1.9.{#SNMPINDEX}</snmp_oid>
                            <key>ltmNodeAddrStatServerCurConns.[{#SNMPVALUE}]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Nodes</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Disponibilidade do Node $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.3375.2.2.4.3.2.1.3.{#SNMPINDEX}</snmp_oid>
                            <key>ltmNodeAddrStatusAvailState[{#SNMPVALUE}]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Nodes</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Template BigIP - Disponibilidade Pool</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Status de disponibilidade do node $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.3375.2.2.4.3.2.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>ltmNodeAddrStatusDetailReason[{#SNMPVALUE}]</key>
                            <delay>3600</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>Nodes</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Status do Node $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.3375.2.2.4.3.2.1.4.{#SNMPINDEX}</snmp_oid>
                            <key>ltmNodeAddrStatusEnabledState[{#SNMPVALUE}]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Nodes</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Template BigIP - Status Node</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Pools</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.4.1.3375.2.2.5.1.2.1.1]</snmp_oid>
                    <key>ltmPoolName</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Membros Ativos no Pool $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.1.2.1.8.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolActiveMemberCnt.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>120</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Membros do Pool $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.1.2.1.23.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolMemberCnt.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>120</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Entrada de Bytes no Pool $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.2.3.1.3.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatServerBytesIn.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Saída de Bytes no Pool $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.2.3.1.5.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatServerBytesOut.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Conexões Ativas em $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.3375.2.2.5.2.3.1.8.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatServerCurConns.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Total de Conexões em $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.2.3.1.7.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatServerTotConns.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>60</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Status de Disponibilidade do Pool $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.5.2.1.2.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatusAvailState.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>120</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Template BigIP - Disponibilidade Pool</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last(0)}&lt;&gt;1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last(0)}=1</recovery_expression>
                                    <name>Pool {#SNMPVALUE} Indisponível. (Status Atual: {ITEM.VALUE1}).</name>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>Status de Disponibilidade $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>.1.3.6.1.4.1.3375.2.2.5.5.2.1.5.&quot;{#SNMPVALUE}&quot;</snmp_oid>
                            <key>ltmPoolStatusDetailReason.[&quot;{#SNMPVALUE}&quot;]</key>
                            <delay>60;50/1-7,00:00-24:00</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>Pool</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network F5:ltmPoolActiveMemberCnt.[&quot;{#SNMPVALUE}&quot;].last(0)}&lt;&gt;{CLIENTE - Template Network F5:ltmPoolMemberCnt.[&quot;{#SNMPVALUE}&quot;].last(0)}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network F5:ltmPoolActiveMemberCnt.[&quot;{#SNMPVALUE}&quot;].last(0)}={CLIENTE - Template Network F5:ltmPoolMemberCnt.[&quot;{#SNMPVALUE}&quot;].last(0)}</recovery_expression>
                            <name>Existem Nodes do Pool {#SNMPVALUE} desativados ou apresentando problemas - ({ITEM.LASTVALUE}/{ITEM.LASTVALUE2}) - Ativos / Total</name>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$SNMP_COMMUNITY}</macro>
                    <value>public</value>
                </macro>
            </macros>
        </template>
        <template>
            <template>CLIENTE - Template Network Fortigate HA Sync</template>
            <name>CLIENTE - Template Network Fortigate HA Sync</name>
            <description>HA Fortigate</description>
            <groups>
                <group>
                    <name>Templates/CLIENTE/Network</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>HA Availability</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Ha Auto Sync</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.13.1.5.0</snmp_oid>
                    <key>fgHaAutoSync</key>
                    <delay>1h</delay>
                    <history>365d</history>
                    <trends>7d</trends>
                    <description>FnBoolState (INTEGER) {disabled (1),&#13;
enabled (2)</description>
                    <applications>
                        <application>
                            <name>HA Availability</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Fortigate HA Auto Sync</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=1</expression>
                            <name>HA Auto Sync- {HOST.NAME} - Disable</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Ha Group Name</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.13.1.7.0</snmp_oid>
                    <key>fgHaGroupName</key>
                    <delay>1d</delay>
                    <history>365d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <applications>
                        <application>
                            <name>HA Availability</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Ha Stats Sync Status</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.13.2.1.1.12.1</snmp_oid>
                    <key>fgHaStatsSyncStatus</key>
                    <delay>60s</delay>
                    <history>365d</history>
                    <trends>7d</trends>
                    <description>FgHaStatsSyncStatusType (INTEGER) {unsynchronized(0), synchronized(1) }</description>
                    <applications>
                        <application>
                            <name>HA Availability</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Fortigate Satus HA</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{last()}=0</expression>
                            <name>HA - {HOST.NAME} - UnSynchronized</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Ha System Mode</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.13.1.1.0</snmp_oid>
                    <key>fgHaSystemMode</key>
                    <delay>3600s</delay>
                    <history>365d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>FgHaMode (INTEGER) {standalone(1), activeActive(2),&#13;
activePassive(3) }</description>
                    <applications>
                        <application>
                            <name>HA Availability</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>Fortigate  Ha System Mode</name>
                    </valuemap>
                </item>
            </items>
        </template>
        <template>
            <template>CLIENTE - Template Network Fortinet</template>
            <name>CLIENTE - Template Network Fortinet</name>
            <groups>
                <group>
                    <name>Templates/CLIENTE/Network</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Fortinet General</name>
                </application>
                <application>
                    <name>Fortinet Performance</name>
                </application>
                <application>
                    <name>Interfaces Discovery</name>
                </application>
                <application>
                    <name>Link 10/100/1000</name>
                </application>
                <application>
                    <name>Network Traffic</name>
                </application>
                <application>
                    <name>Port Status</name>
                </application>
                <application>
                    <name>Storage</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Current connections</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>1.3.6.1.4.1.12356.101.4.1.8.0</snmp_oid>
                    <key>fortinetCurrentConnections</key>
                    <history>7d</history>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Current CPU Util</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.3.0</snmp_oid>
                    <key>fortinetCurrentCPUUtil</key>
                    <history>7d</history>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(3)}&gt;=70</expression>
                            <name>Fortinet {HOSTNAME} - Usage of CPU equal or over 70% in the last 3 times checked (Total 3 minutes)</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{avg(3)}&gt;=90</expression>
                            <name>Fortinet {HOSTNAME} - Usage of CPU equal or over 90% in the last 3 times checked (Total 3 minutes)</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Current RAM Usage</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.4.0</snmp_oid>
                    <key>fortinetCurrentRAMUtil</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(#3)}&gt;70</expression>
                            <name>Fortinet {HOSTNAME} - Memory Usage equal or over 70% in the last 3 times checked (Total 3 minutes)</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{avg(#3)}&gt;90</expression>
                            <name>Fortinet {HOSTNAME} - Memory Usage equal or over 90% in the last 3 times checked (Total 3 minutes)</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Total storage space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.7.0</snmp_oid>
                    <key>fortinetTotalStorage</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                        <application>
                            <name>Storage</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1000000</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Fortinet Uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.20.0</snmp_oid>
                    <key>fortinetUpTime</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1e-2</params>
                        </step>
                    </preprocessing>
                    <triggers>
                        <trigger>
                            <expression>{last(#10)}&gt;{last(0)}</expression>
                            <name>Fortinet {HOST.NAME} Rebooted</name>
                            <priority>WARNING</priority>
                            <description>The Fortinet has been rebooted during last 10 checks</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Used storage space</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.6.0</snmp_oid>
                    <key>fortinetUsedStorage</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>B</units>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                        <application>
                            <name>Storage</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1000000</params>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Fortinet Used Storage %</name>
                    <type>CALCULATED</type>
                    <key>fortinetUsedStorage-percent</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>100*last(&quot;fortinetUsedStorage&quot;)/last(&quot;fortinetTotalStorage&quot;)</params>
                    <applications>
                        <application>
                            <name>Fortinet Performance</name>
                        </application>
                        <application>
                            <name>Storage</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Firmware Version</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.4.1.1.0</snmp_oid>
                    <key>SysmFirmwareVersion</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>CHAR</value_type>
                    <inventory_link>OS</inventory_link>
                    <applications>
                        <application>
                            <name>Fortinet General</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Serial Number</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.12356.100.1.1.1.0</snmp_oid>
                    <key>SysmSerialNumber</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <trends>0</trends>
                    <status>DISABLED</status>
                    <value_type>CHAR</value_type>
                    <inventory_link>SERIALNO_A</inventory_link>
                    <applications>
                        <application>
                            <name>Fortinet General</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network Interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.31.1.1.1.1]</snmp_oid>
                    <key>ifname</key>
                    <delay>1d</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>Outgoing $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network Traffic</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Link Speed $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeed[{#SNMPVALUE}]</key>
                            <delay>1d</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Link 10/100/1000</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming $1</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifInOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>Network Traffic</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Network Traffic {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>CLIENTE - Template Network Fortinet</host>
                                        <key>ifInOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>CLIENTE - Template Network Fortinet</host>
                                        <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network HSRP</template>
            <name>CLIENTE - Template Network HSRP</name>
            <description>Tested in n5k and n7k, probably will work without problem in IOS devices.&#13;
&#13;
This template has three triggers items:&#13;
&#13;
First checks if cHsrpGrpStandbyState has changed from any value to any value (what indicates a flap in protocol).&#13;
&#13;
Second checks if there is a standby router at the group, if not, Cisco box returns UNKNOWN standby router = 0.0.0.0 (as string). &#13;
Trigger starts based on value obtained from cHsrpGrpStandbyRouter, if &quot;0.0.0.0&quot; generates a problem, if not equal 0.0.0.0 anymore, then release problem.&#13;
&#13;
Third checks constantily if active router of VIP has changed, but will close if any value were received (Its just for informational purposes).&#13;
&#13;
Enjoy!&#13;
Created by:&#13;
Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>HSRP</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>HSRP VIP</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.106.1.2.1.1.11,{#SNMPVALUE2},1.3.6.1.4.1.9.9.106.1.2.1.1.1]</snmp_oid>
                    <key>cHsrpGrpVirtualIpAddr</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>0.0.0.0</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Macros:&#13;
&#13;
SNMPVALUE = vip address.&#13;
&#13;
(I am filtering vip addr 0.0.0.0. If someone enable hsrp group x on interface, but does not configure a vip address, vip addr returned will be 0.0.0.0, and if you do this twice or more, this will generate duplicate useless items).&#13;
&#13;
SNMPVALUE2 = hsrp group number.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>HSRP Active Router to group {#SNMPVALUE2} and VIP {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.106.1.2.1.1.13.{#SNMPINDEX}</snmp_oid>
                            <key>cHsrpGrpActiveRouter[{#SNMPVALUE}]</key>
                            <history>1w</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>HSRP</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{nodata(300)}=0</recovery_expression>
                                    <name>INFORMATIONAL - Active router for HSRP Group {#SNMPVALUE2} VIP {#SNMPVALUE} on {HOSTNAME} has changed to {ITEM.VALUE}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>HSRP Standby Router to group {#SNMPVALUE2} and VIP {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.106.1.2.1.1.14.{#SNMPINDEX}</snmp_oid>
                            <key>cHsrpGrpStandbyRouter[{#SNMPVALUE}]</key>
                            <history>1w</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>HSRP</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{str(0.0.0.0)}=1</expression>
                                    <name>Standby router is UNKNOWN for HSRP Group {#SNMPVALUE2} VIP {#SNMPVALUE} on {HOSTNAME}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>HSRP Group {#SNMPVALUE2} VIP {#SNMPVALUE} status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.106.1.2.1.1.15.{#SNMPINDEX}</snmp_oid>
                            <key>cHsrpGrpStandbyState[{#SNMPVALUE}]</key>
                            <history>1w</history>
                            <description>Traz estado HSRP do VIP.</description>
                            <applications>
                                <application>
                                    <name>HSRP</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>cHsrpGrpStandbyState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=5 or {last()}=6</recovery_expression>
                                    <name>HSRP Group {#SNMPVALUE2} VIP {#SNMPVALUE} status has changed to {ITEM.VALUE1} on {HOSTNAME}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Interfaces 1</template>
            <name>CLIENTE - Template Network Interfaces 1</name>
            <description>Template de coleta de interfaces padrão para os equipamentos administrados pelo time TMM redes CLIENTE.&#13;
&#13;
Triggers:&#13;
Consumo de interface superior a 90%.&#13;
Interface flapping (up/down, down/up).&#13;
Sem resposta SNMP.&#13;
Alerta de reboot da caixa baseado em uptime.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>ifInDiscards</name>
                </application>
                <application>
                    <name>ifInErrors</name>
                </application>
                <application>
                    <name>ifOutDiscards</name>
                </application>
                <application>
                    <name>ifOutErrors</name>
                </application>
                <application>
                    <name>Interfaces_Speed</name>
                </application>
                <application>
                    <name>interface_traffic_in</name>
                </application>
                <application>
                    <name>interface_traffic_out</name>
                </application>
                <application>
                    <name>SNMP_alive</name>
                </application>
                <application>
                    <name>Status Interface</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>pacotes perdidos icmp</name>
                    <type>SIMPLE</type>
                    <key>icmppingloss[{HOST.CONN},,,,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$ICMP_LOSS}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(15m)}&lt;{$ICMP_LOSS}</recovery_expression>
                            <name>perdendo pacotes icmp {ITEM.LASTVALUE}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>disponibilidade por icmp</name>
                    <type>SIMPLE</type>
                    <key>icmpping[{HOST.CONN},,,,]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <valuemap>
                        <name>Service state</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&lt;1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(15m)}&gt;0</recovery_expression>
                            <name>host indisponivel por ping {ITEM.LASTVALUE}</name>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Device uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
                    <key>sysUpTime</key>
                    <delay>5m</delay>
                    <history>4d</history>
                    <trends>30d</trends>
                    <units>uptime</units>
                    <description>servico ou processo inoperante</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted</name>
                            <description>hcp-redes</description>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(5m)}&lt;1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(15m)}&gt;0</recovery_expression>
                            <name>snmp nao disponivel</name>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interfaces</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescr</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatus[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed Interface {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeed[{#SNMPVALUE}]</key>
                            <delay>1h</delay>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>Interfaces_Speed</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscards[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifInErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrors[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatus[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco ifOperStatus</name>
                            </valuemap>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscards[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifOutErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrors[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces 1:ifHCInOctets[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces 1:ifHighSpeed[{#SNMPVALUE}].last()} &gt; 0.9 or {CLIENTE - Template Network Interfaces 1:ifHCOutOctets[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces 1:ifHighSpeed[{#SNMPVALUE}].last()} &gt; 0.9</expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - Consumo IN ou OUT superior a 90%, IN {ITEM.VALUE1}, OUT {ITEM.VALUE3}</name>
                            <description>hcp-redes</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces 1:ifOperStatus[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces 1:ifAdminStatus[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces 1:ifOperStatus[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <description>hcp-redes</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifHCInOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifInErrors[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifOutErrors[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF0000</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifInDiscards[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifOutDiscards[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
                <discovery_rule>
                    <name>Logical Network interfaces (example - vlan)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescrvlan</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces 1:ifOperStatusvlan[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces 1:ifAdminStatusvlan[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces 1:ifOperStatusvlan[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <priority>HIGH</priority>
                            <description>hcp-redes</description>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface vlan - {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <drawtype>GRADIENT_LINE</drawtype>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces 1</host>
                                        <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Interfaces granular</template>
            <name>CLIENTE - Template Network Interfaces granular</name>
            <description>Criado por Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>ifInDiscards</name>
                </application>
                <application>
                    <name>ifInErrors</name>
                </application>
                <application>
                    <name>ifOutDiscards</name>
                </application>
                <application>
                    <name>ifOutErrors</name>
                </application>
                <application>
                    <name>Interfaces_Speed</name>
                </application>
                <application>
                    <name>interface_traffic_in</name>
                </application>
                <application>
                    <name>interface_traffic_out</name>
                </application>
                <application>
                    <name>SNMP_alive</name>
                </application>
                <application>
                    <name>Status Interface</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Device uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
                    <key>sysUpTime</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>uptime</units>
                    <description>servico ou processo inoperante</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(5m)}&lt;1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(15m)}&gt;0</recovery_expression>
                            <name>snmp nao disponivel</name>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interfaces important(desc MON)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescimportant</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)MON.*)</value>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)L2L.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Trigger nesse rule com classificação P3-P1.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed Interface {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeedimportant[{#SNMPVALUE}]</key>
                            <delay>1h</delay>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>Interfaces_Speed</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscardsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifInErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrorsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscardsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifOutErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrorsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifHCInOctetsimportant[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeedimportant[{#SNMPVALUE}].last()} &gt; 0.9 or {CLIENTE - Template Network Interfaces granular:ifHCOutOctetsimportant[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeedimportant[{#SNMPVALUE}].last()} &gt; 0.9</expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - Consumo IN ou OUT superior a 90%, IN {ITEM.VALUE1}, OUT {ITEM.VALUE3}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifOperStatusimportant[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular:ifAdminStatusimportant[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular:ifOperStatusimportant[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCInOctetsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCOutOctetsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInErrorsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutErrorsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF0000</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInDiscardsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutDiscardsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interfaces not important</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescr</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)MON.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)L2L.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>C</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>Trigger nesse rule com classificação P5 ou not classified.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatus[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed Interface {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeed[{#SNMPVALUE}]</key>
                            <delay>1h</delay>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>Interfaces_Speed</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscards[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifInErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrors[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatus[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                            <request_method>POST</request_method>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscards[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifOutErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrors[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <request_method>POST</request_method>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifHCInOctets[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeed[{#SNMPVALUE}].last()} &gt; 0.9 or {CLIENTE - Template Network Interfaces granular:ifHCOutOctets[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeed[{#SNMPVALUE}].last()} &gt; 0.9</expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - Consumo IN ou OUT superior a 90%, IN {ITEM.VALUE1}, OUT {ITEM.VALUE3}</name>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifOperStatus[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular:ifAdminStatus[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular:ifOperStatus[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} from {ITEM.LASTVALUE1} to {ITEM.VALUE1}</name>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#SNMPVALUE} -- {#SNMPVALUE2}</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCInOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCOutOctets[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInErrors[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutErrors[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF0000</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInDiscards[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutDiscards[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <request_method>POST</request_method>
                </discovery_rule>
                <discovery_rule>
                    <name>Logical Network interfaces (example - vlan)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescrlogical</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifOperStatusvlan[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular:ifAdminStatusvlan[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular:ifOperStatusvlan[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface vlan - {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Network interfaces L2L</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescr_L2L</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)L2L.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed Interface {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeedL2L[{#SNMPVALUE}]</key>
                            <delay>1h</delay>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>Interfaces_Speed</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscardsL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInDiscards</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>ifInErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrorsL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInErrors</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscardsL2L[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutDiscards</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>ifOutErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrorsL2[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutErrors</name>
                                </application>
                            </applications>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifHCInOctetsL2L[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeedL2L[{#SNMPVALUE}].last()} &gt; 0.9 or {CLIENTE - Template Network Interfaces granular:ifHCOutOctetsL2L[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular:ifHighSpeedL2L[{#SNMPVALUE}].last()} &gt; 0.9</expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - Consumo IN ou OUT superior a 90%, IN {ITEM.VALUE1}, OUT {ITEM.VALUE3}</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular:ifOperStatusL2L[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular:ifAdminStatusL2L[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular:ifOperStatusL2L[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#SNMPVALUE} - {#SNMPVALUE2} - L2L</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCInOctetsL2L[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifHCOutOctetsL2L[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInErrorsL2L[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutErrorsL2[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF0000</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifInDiscardsL2L[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular</host>
                                        <key>ifOutDiscardsL2L[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Interfaces granular - Satelites</template>
            <name>CLIENTE - Template Network Interfaces granular - Satelites</name>
            <description>Template de coleta de interfaces padrão para os equipamentos administrados pelo time TMM CLIENTE dos sites Satelites.&#13;
&#13;
Obs: Esse template cria trigger e faz coleta de interfaces se encontrar a string UP-LINK|UPLINK|SW|LINK|FW|Switch) na desc da interface.&#13;
&#13;
&#13;
Triggers:&#13;
Consumo de interface superior a 90%.&#13;
Interface flapping (up/down, down/up).&#13;
Sem resposta SNMP.&#13;
Alerta de reboot da caixa baseado em uptime.&#13;
&#13;
Criado por Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Satelites</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>General</name>
                </application>
                <application>
                    <name>ifInDiscards</name>
                </application>
                <application>
                    <name>ifInErrors</name>
                </application>
                <application>
                    <name>ifOutDiscards</name>
                </application>
                <application>
                    <name>ifOutErrors</name>
                </application>
                <application>
                    <name>Interfaces_Speed</name>
                </application>
                <application>
                    <name>interface_traffic_in</name>
                </application>
                <application>
                    <name>interface_traffic_out</name>
                </application>
                <application>
                    <name>SNMP_alive</name>
                </application>
                <application>
                    <name>Status Interface</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Device uptime</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>SNMPv2-MIB::sysUpTime.0</snmp_oid>
                    <key>sysUpTime</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <units>uptime</units>
                    <description>servico ou processo inoperante</description>
                    <applications>
                        <application>
                            <name>General</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.01</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last()}&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>SNMP agent availability</name>
                    <type>INTERNAL</type>
                    <key>zabbix[host,snmp,available]</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <valuemap>
                        <name>zabbix.host.available</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(5m)}&lt;1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(15m)}&gt;0</recovery_expression>
                            <name>snmp nao disponivel -  IP REAL {HOST.IP}</name>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Network interfaces important(UP-LINK|UPLINK|SW|LINK|FW|Switch)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescimportant</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE2}</macro>
                                <value>(.*(?i)UP-LINK.*|.*UPLINK.*|.*SW.*|.*LINK.*|.*FW.*|.*Switch.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>UP-LINK|UPLINK|SW|LINK|FW|Switch (maisculo ou minusculo, tanto faz)&#13;
&#13;
&#13;
REGEX: (.*(?i)UP-LINK.*|.*UPLINK.*|.*SW.*|.*LINK.*|.*FW.*|.*Switch.*)</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Speed Interface {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHighSpeed.{#SNMPINDEX}</snmp_oid>
                            <key>ifHighSpeedimportant[{#SNMPVALUE}]</key>
                            <delay>1h</delay>
                            <history>1w</history>
                            <units>b</units>
                            <applications>
                                <application>
                                    <name>Interfaces_Speed</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>1000000</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Inbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifInDiscardsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifInErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifInErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifInErrorsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifInErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Interface {#SNMPVALUE} - {#SNMPVALUE2} - Outbound packets discarded</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutDiscards.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutDiscardsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutDiscards</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>ifOutErrors {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOutErrors.{#SNMPINDEX}</snmp_oid>
                            <key>ifOutErrorsimportant[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>ifOutErrors</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                            </preprocessing>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular - Satelites:ifHCInOctetsimportant[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular - Satelites:ifHighSpeedimportant[{#SNMPVALUE}].last()} &gt; 0.9 or {CLIENTE - Template Network Interfaces granular - Satelites:ifHCOutOctetsimportant[{#SNMPVALUE}].last()} / {CLIENTE - Template Network Interfaces granular - Satelites:ifHighSpeedimportant[{#SNMPVALUE}].last()} &gt; 0.9</expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - Consumo IN ou OUT superior a 90%, IN {ITEM.VALUE1}, OUT {ITEM.VALUE3}</name>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular - Satelites:ifOperStatusimportant[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular - Satelites:ifAdminStatusimportant[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular - Satelites:ifOperStatusimportant[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifHCInOctetsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifHCOutOctetsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>2</sortorder>
                                    <color>2774A4</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifInErrorsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>3</sortorder>
                                    <color>A54F10</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifOutErrorsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>4</sortorder>
                                    <color>FF0000</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifInDiscardsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>5</sortorder>
                                    <color>6C59DC</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifOutDiscardsimportant[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Logical Network interfaces (example - vlan)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},IF-MIB::ifDescr,{#SNMPVALUE2},IF-MIB::ifAlias]</snmp_oid>
                    <key>ifDescrlogical</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*(?i)vlan.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#SNMPVALUE}</macro>
                                <value>(.*unrouted.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <name>Admin status {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifAdminStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifAdminStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>adm status Interface</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Incoming traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCInOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <units>bps</units>
                            <applications>
                                <application>
                                    <name>interface_traffic_in</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Outgoing traffic on interface {#SNMPVALUE} - {#SNMPVALUE2}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifHCOutOctets.{#SNMPINDEX}</snmp_oid>
                            <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>interface_traffic_out</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>CHANGE_PER_SECOND</type>
                                    <params/>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <params>8</params>
                                </step>
                            </preprocessing>
                        </item_prototype>
                        <item_prototype>
                            <name>Operational status {#SNMPVALUE}</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>IF-MIB::ifOperStatus.{#SNMPINDEX}</snmp_oid>
                            <key>ifOperStatusvlan[{#SNMPVALUE}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <applications>
                                <application>
                                    <name>Status Interface</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>IF-MIB::ifOperStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Interfaces granular - Satelites:ifOperStatusvlan[{#SNMPVALUE}].diff()}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{CLIENTE - Template Network Interfaces granular - Satelites:ifAdminStatusvlan[{#SNMPVALUE}].last()}=2 or {CLIENTE - Template Network Interfaces granular - Satelites:ifOperStatusvlan[{#SNMPVALUE}].last()}=1</recovery_expression>
                            <name>{#SNMPVALUE} - {#SNMPVALUE2} - status changed on {HOST.NAME} to {ITEM.VALUE1}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>Traffic on interface vlan - {#SNMPVALUE}</name>
                            <graph_items>
                                <graph_item>
                                    <color>007700</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifHCInOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>0000DD</color>
                                    <item>
                                        <host>CLIENTE - Template Network Interfaces granular - Satelites</host>
                                        <key>ifHCOutOctetsvlan[{#SNMPVALUE}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Junos</template>
            <name>CLIENTE - Template Network Junos</name>
            <description>Based only on JUNIPER-MIB.&#13;
Tested in EX-4200 in Virtual chassis mode.&#13;
&#13;
- Get components (FPCs, REs, FANs, PWs,PICs ...) and status (unknown(1),, empty(2), filled(3)) with trigger that checks a change in these status.&#13;
If you insert something or remove something an alarm will be generated too.&#13;
&#13;
- Get Temperature, Memory and CPU utilization for REs and FPCs with triggers based on my needs (you can change for your needs).&#13;
&#13;
Enjoy!&#13;
Created by:&#13;
Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>junipercomponent</name>
                </application>
                <application>
                    <name>junipercpuutil</name>
                </application>
                <application>
                    <name>junipermemory</name>
                </application>
                <application>
                    <name>junipertemperature</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>Box components (minus FPCs and REs)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#COMPONENT},1.3.6.1.4.1.2636.3.1.12.1.5]</snmp_oid>
                    <key>boxcomponents</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#COMPONENT}</macro>
                                <value>(.*FPC.*|.*Engine.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Macro COMPONENT = value is a string that represents an individual component.&#13;
JUNIPER-MIB::jnxFilledDescr&#13;
This will be our index item.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#COMPONENT} status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.2636.3.1.12.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>jnxFilledState[{#COMPONENT}-index-{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>4d</history>
                            <trends>2w</trends>
                            <description>jnxFilledState	1.3.6.1.4.1.2636.3.1.12.1.6&#13;
&#13;
Status can be:&#13;
unknown(1),&#13;
empty(2),&#13;
filled(3)</description>
                            <applications>
                                <application>
                                    <name>junipercomponent</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>jnxFilledState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;&gt;1</recovery_expression>
                                    <name>{#COMPONENT} status has changed to {ITEM.VALUE1}</name>
                                    <priority>AVERAGE</priority>
                                    <description>hcp-redes</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Box components (FPCs and REs)</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#REORFPC},1.3.6.1.4.1.2636.3.1.12.1.5]</snmp_oid>
                    <key>REsandFPCs</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#REORFPC}</macro>
                                <value>(.*FPC.*|.*Engine.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <description>Macro REORFPC = value is a string that represents an individual component (RE or FPC).&#13;
JUNIPER-MIB::jnxFilledDescr&#13;
This will be our index item.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#REORFPC} status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.2636.3.1.12.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>jnxFilledState[{#REORFPC}-index-{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>4d</history>
                            <trends>2w</trends>
                            <description>jnxFilledState	1.3.6.1.4.1.2636.3.1.12.1.6&#13;
&#13;
Status can be:&#13;
unknown(1),&#13;
empty(2),&#13;
filled(3)</description>
                            <applications>
                                <application>
                                    <name>junipercomponent</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>jnxFilledState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;&gt;1</recovery_expression>
                                    <name>{#REORFPC} status has changed to {ITEM.VALUE1}</name>
                                    <priority>DISASTER</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#REORFPC} CPU Utilization average 1 min</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.2636.3.1.13.1.8.{#SNMPINDEX}</snmp_oid>
                            <key>jnxOperating1MinLoadAvg[{#REORFPC}-index-{#SNMPINDEX}]</key>
                            <history>4d</history>
                            <trends>2w</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>jnxOperating1MinLoadAvg 1.3.6.1.4.1.2636.3.1.13.1.20&#13;
CPU utilization in % avg 1 min.&#13;
&#13;
obs: Alterado para jnxOperatingCPU 1.3.6.1.4.1.2636.3.1.13.1.8.</description>
                            <applications>
                                <application>
                                    <name>junipercpuutil</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg(#3)}&gt;=70</expression>
                                    <name>CPU utilization of {#REORFPC} reached 70% or more in the last 3 times checked</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{avg(#3)}&gt;=90</expression>
                                    <name>CPU utilization of {#REORFPC} reached 90% or more in the last 3 times checked</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#REORFPC} Memory Utilization</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.2636.3.1.13.1.11.{#SNMPINDEX}</snmp_oid>
                            <key>jnxOperatingBuffer[{#REORFPC}-index-{#SNMPINDEX}]</key>
                            <history>4d</history>
                            <trends>2w</trends>
                            <value_type>FLOAT</value_type>
                            <units>%</units>
                            <description>jnxOperatingBuffer	1.3.6.1.4.1.2636.3.1.12.1.6&#13;
memory utilization in %.</description>
                            <applications>
                                <application>
                                    <name>junipermemory</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;=70</expression>
                                    <name>Memory utilization of {#REORFPC} reached 70% or more</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;=90</expression>
                                    <name>Memory utilization of {#REORFPC} reached 90% or more</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>{#REORFPC} Temperature</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.2636.3.1.13.1.7.{#SNMPINDEX}</snmp_oid>
                            <key>jnxOperatingTemp[{#REORFPC}-index-{#SNMPINDEX}]</key>
                            <delay>3m</delay>
                            <history>4d</history>
                            <trends>2w</trends>
                            <value_type>FLOAT</value_type>
                            <units>ºC</units>
                            <description>jnxOperatingTemp 1.3.6.1.4.1.2636.3.1.13.1.7&#13;
temperature in ºc.</description>
                            <applications>
                                <application>
                                    <name>junipertemperature</name>
                                </application>
                            </applications>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;=95</expression>
                                    <name>Red alarm - {#REORFPC} reached {ITEM.VALUE} of temperature</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;=70 and {last()}&lt;81</expression>
                                    <name>Warning alarm - {#REORFPC} reached {ITEM.VALUE} of temperature</name>
                                    <priority>WARNING</priority>
                                    <description>hcp-redes</description>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;=81 and {last()}&lt;95</expression>
                                    <name>Yellow alarm - {#REORFPC} reached {ITEM.VALUE} of temperature</name>
                                    <priority>DISASTER</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <name>{#REORFPC}  Memory and CPU Utilization</name>
                            <graph_items>
                                <graph_item>
                                    <color>1A7C11</color>
                                    <item>
                                        <host>CLIENTE - Template Network Junos</host>
                                        <key>jnxOperating1MinLoadAvg[{#REORFPC}-index-{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                                <graph_item>
                                    <sortorder>1</sortorder>
                                    <color>F63100</color>
                                    <item>
                                        <host>CLIENTE - Template Network Junos</host>
                                        <key>jnxOperatingBuffer[{#REORFPC}-index-{#SNMPINDEX}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network Nexus 9K</template>
            <name>CLIENTE - Template Network Nexus 9K</name>
            <description>Discovery:&#13;
&#13;
SUPs and modules, with operational status trigger.&#13;
Power supply , with operational status trigger.&#13;
Fans,  with operational status trigger.&#13;
&#13;
------------------------------------------------------------------------------&#13;
&#13;
Fixed items:&#13;
&#13;
CPU avg 5 min utilization with trigger.&#13;
Memory utilization with trigger.&#13;
&#13;
Enjoy!&#13;
Created by:&#13;
Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>cpu</name>
                </application>
                <application>
                    <name>fan</name>
                </application>
                <application>
                    <name>memory</name>
                </application>
                <application>
                    <name>module</name>
                </application>
                <application>
                    <name>psupply</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>CPU utilization avg 5 min</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.9.9.109.1.1.1.1.8.1</snmp_oid>
                    <key>cpmCPUTotal5minRev</key>
                    <delay>5m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>cpu</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(#3)}&gt;=70</expression>
                            <name>CPU utilization reached 70% or more in the last 3 times checked</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                        <trigger>
                            <expression>{avg(#3)}&gt;=90</expression>
                            <name>CPU utilization reached 90% or more in the last 3 times checked</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Memory utilization in %</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>.1.3.6.1.4.1.9.9.305.1.1.2.0</snmp_oid>
                    <key>cseSysMemoryUtilization</key>
                    <delay>3m</delay>
                    <history>7d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <applications>
                        <application>
                            <name>memory</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;=90</expression>
                            <name>Memory utilization reached 90% or more</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Modules and SUPs</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#MODANDSUP},1.3.6.1.2.1.47.1.1.1.1.2,{#SNMODULES},1.3.6.1.2.1.47.1.1.1.1.11]</snmp_oid>
                    <key>entPhysicalEntryandentPhysicalSerialNum</key>
                    <delay>1d</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#MODANDSUP}</macro>
                                <value>(^[0-9].*|.*Supervisor.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>entPhysicalEntry 1.3.6.1.2.1.47.1.1.1.1.2 regex (.*Supervisor.*|.*Module.*)&#13;
entPhysicalSerialNum 1.3.6.1.2.1.47.1.1.1.1.11</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Module {#MODANDSUP} SN {#SNMODULES} admin status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.117.1.2.1.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cefcModuleAdminStatus[{#MODANDSUP}-SN-{#SNMODULES}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>395d</trends>
                            <applications>
                                <application>
                                    <name>module</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco cefcModuleAdminStatus</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>Module {#MODANDSUP} SN {#SNMODULES} operational status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.117.1.2.1.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>cefcModuleOperStatus[{#MODANDSUP}-SN-{#SNMODULES}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>395d</trends>
                            <applications>
                                <application>
                                    <name>module</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco cefcModuleOperStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Nexus 9K:cefcModuleOperStatus[{#MODANDSUP}-SN-{#SNMODULES}].last()}&lt;&gt;2 and {CLIENTE - Template Network Nexus 9K:cefcModuleAdminStatus[{#MODANDSUP}-SN-{#SNMODULES}].last()}&lt;&gt;2</expression>
                            <name>Module {#MODANDSUP} SN {#SNMODULES} operational status is not OK. Current status is {ITEM.VALUE}</name>
                            <priority>DISASTER</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>FANs</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#FAN},1.3.6.1.2.1.47.1.1.1.1.2,{#SNFAN},1.3.6.1.2.1.47.1.1.1.1.11]</snmp_oid>
                    <key>entPhysicalEntryandentPhysicalSerialNum-fans</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#FAN}</macro>
                                <value>(.*FANTRAY.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>entPhysicalEntry 1.3.6.1.2.1.47.1.1.1.1.2 regex matches (.*FANTRAY.*)&#13;
entPhysicalSerialNum 1.3.6.1.2.1.47.1.1.1.1.11</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#FAN} SN {#SNFAN} operational status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.117.1.4.1.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cefcModuleOperStatus[{#FAN}-SN-{#SNFAN}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>395d</trends>
                            <description>cefcFanTrayOperStatus 1.3.6.1.4.1.9.9.117.1.4.1.1.1</description>
                            <applications>
                                <application>
                                    <name>fan</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco cefcFanTrayOperStatus</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&lt;&gt;2</expression>
                                    <name>Fan {#FAN} SN {#SNFAN} is not OK. Current status is {ITEM.VALUE}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Power supply discovery</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#PS},1.3.6.1.2.1.47.1.1.1.1.2,{#SNPS},1.3.6.1.2.1.47.1.1.1.1.11]</snmp_oid>
                    <key>entPhysicalEntryandentPhysicalSerialNum-powersupply</key>
                    <delay>1d</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#PS}</macro>
                                <value>(.*-AC-.*|PS|.*-PAC-.*)</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#PS}</macro>
                                <value>(.*Slot.*)</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>7d</lifetime>
                    <description>entPhysicalEntry 1.3.6.1.2.1.47.1.1.1.1.2 regex matches (.*-AC-.*|PS) and does not match (.*Slot.*).&#13;
entPhysicalSerialNum 1.3.6.1.2.1.47.1.1.1.1.11</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>{#PS} SN {#SNPS} admin status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.117.1.1.2.1.1.{#SNMPINDEX}</snmp_oid>
                            <key>cefcFRUPowerAdminStatus[{#PS}-SN-{#SNPS}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>395d</trends>
                            <description>cefcFRUPowerAdminStatus	1.3.6.1.4.1.9.9.117.1.1.2.1.1</description>
                            <applications>
                                <application>
                                    <name>psupply</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco cefcFRUPowerAdminStatus</name>
                            </valuemap>
                        </item_prototype>
                        <item_prototype>
                            <name>{#PS} SN {#SNPS} operational status</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.4.1.9.9.117.1.1.2.1.2.{#SNMPINDEX}</snmp_oid>
                            <key>cefcFRUPowerOperStatus[{#PS}-SN-{#SNPS}]</key>
                            <delay>5m</delay>
                            <history>7d</history>
                            <trends>395d</trends>
                            <description>cefcFRUPowerOperStatus 1.3.6.1.4.1.9.9.117.1.1.2.1.2</description>
                            <applications>
                                <application>
                                    <name>psupply</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>Cisco cefcFRUPowerOperStatus</name>
                            </valuemap>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{CLIENTE - Template Network Nexus 9K:cefcFRUPowerOperStatus[{#PS}-SN-{#SNPS}].last()}&lt;&gt;2 and {CLIENTE - Template Network Nexus 9K:cefcFRUPowerAdminStatus[{#PS}-SN-{#SNPS}].last()}&lt;&gt;2</expression>
                            <name>{#PS} SN {#SNPS} operational status is not OK. Current status is {ITEM.VALUE}</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
        <template>
            <template>CLIENTE - Template Network OSPF</template>
            <name>CLIENTE - Template Network OSPF</name>
            <description>Trigger&#13;
starts with absense of values from OSPF neighbors monitored.&#13;
&#13;
Recovery:&#13;
If ospfNbrState last(1) = 4 (Twoway/drother) or Full.&#13;
&#13;
Enjoy!&#13;
Created by:&#13;
Danilo Nogueira Ulbrecht.</description>
            <groups>
                <group>
                    <name>Company/CLIENTE/NetworkDevices/Datacenter</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>OSPF</name>
                </application>
            </applications>
            <discovery_rules>
                <discovery_rule>
                    <name>OSPF Neighbors</name>
                    <type>SNMP_AGENT</type>
                    <snmp_oid>discovery[{#SNMPVALUE},.1.3.6.1.2.1.14.10.1.1]</snmp_oid>
                    <key>ospfNbrIpAddr</key>
                    <delay>1d</delay>
                    <lifetime>7d</lifetime>
                    <description>Macro: SNMPVALUE = OSPF Neighbor address.&#13;
Pay attention, this is not the router id.</description>
                    <item_prototypes>
                        <item_prototype>
                            <name>Neighbor {#SNMPVALUE} state</name>
                            <type>SNMP_AGENT</type>
                            <snmp_oid>1.3.6.1.2.1.14.10.1.6.{#SNMPINDEX}</snmp_oid>
                            <key>ospfNbrState[{#SNMPVALUE}]</key>
                            <delay>3m</delay>
                            <history>1w</history>
                            <applications>
                                <application>
                                    <name>OSPF</name>
                                </application>
                            </applications>
                            <valuemap>
                                <name>ospfNbrState</name>
                            </valuemap>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata(360)}=1</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=8 or {last()}=4</recovery_expression>
                                    <name>OSPF neighbor {#SNMPVALUE} on {HOSTNAME} is probably DOWN - no status seen in the last 360 seconds</name>
                                    <priority>INFO</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
            </discovery_rules>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{CLIENTE - Template Network F5:sysChassisFanStatus.1.last()}&lt;&gt;1 or {CLIENTE - Template Network F5:sysChassisFanStatus.2.last()}&lt;&gt;1 or {CLIENTE - Template Network F5:sysChassisFanStatus.3.last()}&lt;&gt;1</expression>
            <name>Mal Funcionamento das Fans</name>
            <priority>WARNING</priority>
            <description>hcp-redes</description>
            <manual_close>YES</manual_close>
        </trigger>
        <trigger>
            <expression>{CLIENTE - Template Network F5:sysChassisPowerSupplyStatus.1.last()}&lt;&gt;1 or {CLIENTE - Template Network F5:sysChassisPowerSupplyStatus.2.last()}&lt;&gt;1</expression>
            <name>Mal Funcionamento das Fontes de Energia</name>
            <priority>WARNING</priority>
            <description>hcp-redes</description>
            <type>MULTIPLE</type>
            <manual_close>YES</manual_close>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>CPU %</name>
            <graph_items>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>1A7C11</color>
                    <item>
                        <host>CLIENTE - Template Network Fortinet</host>
                        <key>fortinetCurrentCPUUtil</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU and Memory Utilization</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>CLIENTE - Template Network Nexus 9K</host>
                        <key>cpmCPUTotal5minRev</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>CLIENTE - Template Network Nexus 9K</host>
                        <key>cseSysMemoryUtilization</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>CPU usage ratio</name>
            <graph_items>
                <graph_item>
                    <item>
                        <host>CLIENTE - Template Network F5</host>
                        <key>sysGlobalHostCpuUsageRatio1m</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Current Connections</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <color>999900</color>
                    <item>
                        <host>CLIENTE - Template Network Fortinet</host>
                        <key>fortinetCurrentConnections</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Disk use</name>
            <width>400</width>
            <height>400</height>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <show_3d>YES</show_3d>
            <graph_items>
                <graph_item>
                    <color>AA0000</color>
                    <item>
                        <host>CLIENTE - Template Network Fortinet</host>
                        <key>fortinetUsedStorage</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>006600</color>
                    <type>GRAPH_SUM</type>
                    <item>
                        <host>CLIENTE - Template Network Fortinet</host>
                        <key>fortinetTotalStorage</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>Memory usage (OS)</name>
            <yaxismax>200</yaxismax>
            <ymax_type_1>ITEM</ymax_type_1>
            <ymax_item_1>
                <host>CLIENTE - Template Network F5</host>
                <key>sysHostMemoryTotal</key>
            </ymax_item_1>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>00DD00</color>
                    <item>
                        <host>CLIENTE - Template Network F5</host>
                        <key>sysHostMemoryTotal</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>EE0000</color>
                    <item>
                        <host>CLIENTE - Template Network F5</host>
                        <key>sysHostMemoryUsed</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>RAM %</name>
            <show_work_period>NO</show_work_period>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>C80000</color>
                    <item>
                        <host>CLIENTE - Template Network Fortinet</host>
                        <key>fortinetCurrentRAMUtil</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>adm status Interface</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>UP</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>DOWN</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>BGP_ADM_STATUS_DEFAULT</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>ADM_DOWN</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>ADM_UP</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>BGP_OPERATIONAL_STATUS_DEFAULT</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>idle</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>connect</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>active</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>opensent</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>openconfirm</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>established</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>cHsrpGrpStandbyState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>initial</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>learn</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>listen</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>speak</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>standby</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>active</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco cefcFanTrayOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>warning</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco cefcFRUPowerAdminStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>on</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>off</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>inlineAuto</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>inlineOn</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>powerCycle</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco cefcFRUPowerOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>offEnvOther</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>on</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>offAdmin</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>offDenied</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>offEnvPower</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>offEnvTemp</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>offEnvFan</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>failed</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>onButFanFail</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>offCooling</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>offConnectorRating</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>onButInlinePowerFail</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco cefcModuleAdminStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>enabled</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>disabled</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>reset</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>outOfServiceAdmin</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco cefcModuleOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>ok</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>disabled</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>okButDiagFailed</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>boot</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>selfTest</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>failed</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>missing</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>mismatchWithParent</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>mismatchConfig</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>diagFailed</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>dormant</newvalue>
                </mapping>
                <mapping>
                    <value>13</value>
                    <newvalue>outOfServiceAdmin</newvalue>
                </mapping>
                <mapping>
                    <value>14</value>
                    <newvalue>outOfServiceEnvTemp</newvalue>
                </mapping>
                <mapping>
                    <value>15</value>
                    <newvalue>poweredDown</newvalue>
                </mapping>
                <mapping>
                    <value>16</value>
                    <newvalue>poweredUp</newvalue>
                </mapping>
                <mapping>
                    <value>17</value>
                    <newvalue>powerDenied</newvalue>
                </mapping>
                <mapping>
                    <value>18</value>
                    <newvalue>powerCycled</newvalue>
                </mapping>
                <mapping>
                    <value>19</value>
                    <newvalue>okButPowerOverWarning</newvalue>
                </mapping>
                <mapping>
                    <value>20</value>
                    <newvalue>okButPowerOverCritical</newvalue>
                </mapping>
                <mapping>
                    <value>21</value>
                    <newvalue>syncInProgress</newvalue>
                </mapping>
                <mapping>
                    <value>22</value>
                    <newvalue>upgrading</newvalue>
                </mapping>
                <mapping>
                    <value>23</value>
                    <newvalue>okButAuthFailed</newvalue>
                </mapping>
                <mapping>
                    <value>24</value>
                    <newvalue>mdr</newvalue>
                </mapping>
                <mapping>
                    <value>25</value>
                    <newvalue>fwMismatchFound</newvalue>
                </mapping>
                <mapping>
                    <value>26</value>
                    <newvalue>fwDownloadSuccess</newvalue>
                </mapping>
                <mapping>
                    <value>27</value>
                    <newvalue>fwDownloadFailure</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Cisco ifOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Testing</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Unknown</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Dormant</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>NotPresent</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>LowerLayerDown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>cswRingRedundant</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>true</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>cswStackPortOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>forcedDown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>cswSwitchRole</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>master</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>member</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>notMember</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>cswSwitchState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>waiting</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>progressing</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>added</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>ready</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>5sdmMismatch</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>verMismatch</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>featureMismatch</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>newMasterInit</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>provisioned</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>invalid</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fortigate HA Auto Sync</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Enabled</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fortigate  Ha System Mode</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>standalone</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>activeActive</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>activePassive</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Fortigate Satus HA</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>unsynchronized</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>synchronized</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>IF-MIB::ifOperStatus</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>up</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>dormant</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>notPresent</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>lowerLayerDown</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>jnxFilledState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>unknown</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>empty</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>filled - OK</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>ospfNbrState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>down</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>attempt</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>init</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>twoWay</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>exchangeStart</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>exchange</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>loading</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>full</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Service state</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Template BigIP - Disponibilidade Pool</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Nenhum</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Disponivel</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Atualmente não disponivel</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>Indisponível</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Disponibilidade desconhecida</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Sem licença</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Template BigIP - Status Fan</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Problema</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Ok</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>Não Disponível</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>Template BigIP - Status Node</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>Enabled</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>AddrDisable</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>ServDisable</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>Disabled</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>Forced_Disabled</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>zabbix.host.available</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>not available</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>available</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>unknown</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
